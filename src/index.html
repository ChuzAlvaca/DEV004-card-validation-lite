<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Tarjeta de crédito válida</title>
</head>

<body>
  <input id="cardnumber"  minlength="10"></input>
  <button onclick="validate();">Validar</button> 
  <div id="result"></div>
  
<script lang="javascript">  
function validate(){
  const arrOfDigits = Array.from(String((document.getElementById ("cardnumber").value)), Number);
  if (arrOfDigits.length === 1) {
    alert ('escribe un número de tarjeta válido');
    return null;
  }
  if (arrOfDigits.length === 0) {
    alert ('escribe un número de tarjeta válido');
    return null;
  }
console.log('Array Original:',arrOfDigits);
arrOfDigits.reverse();
console.log('Array invertido:',arrOfDigits);
arrOfDigits.forEach(function(numero,index) {
  //console.log(numero,index);
  if (index %2 !== 0) {
    j = numero*2;
    //arrOfDigits[index] = j
    if (j>=9){
      substring = j.toString().split('').map(Number);
      //console.log(substring);
    
      //variable de iniciacion, empieza en 0 y va a ir sumando los digitos del array
      //suma los elementos de un array
      k = 0
        substring.forEach(function(numero2, _) {
          k = k + numero2;
        });
      arrOfDigits[index] = k
      console.log(k, "valor");
    }
    else {
      arrOfDigits[index] = j;
    }
  }
});

console.log ('Array final:',arrOfDigits);

k = 0
arrOfDigits.forEach(function(numero, _) {
  k = k + numero;
});

console.log('Numero final:', k);
console.log('modulo 10 de',k, '=', k % 10);
if (k % 10 == 0) {
  var resultado=('Tarjeta Válida');
  console.log(resultado);
  document.getElementById('result').innerHTML = resultado;
}
else {
  var resultado=('Tarjeta Inválida!');
  console.log(resultado);
  document.getElementById('result').innerHTML = resultado;
}
}


</script>
</body>

</html>
